<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
  <channel>
    <title>AlgorithmDog</title>
    <link>http://www.iwgc.cn/list/5566</link>
    <description>AlgorithmDog 讲述机器学习和系统研发的轶事,希望把这些事讲得生动有趣.每周日更新哦.欢迎关注.</description>
    <item>
      <title>平均值和数学期望有多近</title>
      <link>http://www.iwgc.cn/link/2480438</link>
      <description>&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; 一组独立同分布的随机变量，若是变化范围有限，它们的平均值应该很接近它们的数学期望。尤其随机变量个数比较多的情况下，这种现象更加明显。一个鲜明的例子是掷硬币：假设硬币以概率p掷成正面。如果我们掷n(n是一个比较大的数)次硬币，其中有m次为正面，则我们相信&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh8IWqTvpPmjibfBYdW1wlJB6CKF5Sv9RTGdLju0Fz1QjgC92DqAKrdHA/0?wx_fmt=png"/&gt;。假设一组随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhOcoZEKjnLdNBpXPrvp7kH4kZVYDVpAib7DCjHZRoviceicn7uXya4jnwA/0?wx_fmt=png"/&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh1rdSMIkiaSkPhauVHKlu2yoOibbXEqPOdOEGTQmDZTuEW4xw0z4RyJsA/0?wx_fmt=png"/&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhyF97vjWyZxm5ZWRow6od28NJFj4yesETd0ibib5s9mGskoUGSbmbzkXw/0?wx_fmt=png"/&gt;，对应n次掷硬币的结果, 正面为1，负面为0。这组随机变量是独立同分布的，变化范围有限(要么为0要么为1)，而且期望为p。它们的平均值等于正面次数除于总次数，也就是&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhr9b9wyDXaXias1STreCRHecNyO8MJDgInyDlQmUDOtg3G8owHgjSr6g/0?wx_fmt=png"/&gt;。因此，我们相信&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh8IWqTvpPmjibfBYdW1wlJB6CKF5Sv9RTGdLju0Fz1QjgC92DqAKrdHA/0?wx_fmt=png"/&gt;，其实上是相信这组变量的平均值，很接近它们的数学期望。&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;那么问题来了,挖掘机,哦不。一组变化有限的独立同分布随机变量的平均值和期望有多接近呢？换句话说，我们很关心下面的公式会长什么。假设一组独立同分布的随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhOcoZEKjnLdNBpXPrvp7kH4kZVYDVpAib7DCjHZRoviceicn7uXya4jnwA/0?wx_fmt=png"/&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh1rdSMIkiaSkPhauVHKlu2yoOibbXEqPOdOEGTQmDZTuEW4xw0z4RyJsA/0?wx_fmt=png"/&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhyF97vjWyZxm5ZWRow6od28NJFj4yesETd0ibib5s9mGskoUGSbmbzkXw/0?wx_fmt=png"/&gt;，若有&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhDTngnMDaYibGqiaPZLiaKbPByXdMDPY2AnXKNpCSt3z9AiawtXOREdE9kg/0?wx_fmt=png"/&gt;,&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlcXPS6uHo7yCMTMmQOxPADLZSJtO7gPua1EpDpWiablleALA29mfYUA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;一. 平均值和期望&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;为了解决上面的问题，我们应用切尔诺夫不等式。那么什么是切尔诺夫不等式？&lt;br/&gt;&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;切尔诺夫不等式：设随机变量X的特征函数为&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh9o1Pib57g2byN2tWTMd4ibGAEv5kS2Zvib1YpLJX3GcoGvrLXt1dTOsXw/0?wx_fmt=png"/&gt;,&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhbTPpHic3HBj1WicvkSj8dACM0NJ100QlzwmQKQXLNVY6NJrmGTFTLTFQ/0?wx_fmt=png"/&gt;, 则有&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhyH0vBTjicBbTPHLkAqDSLDk57KKsxsu3elrZqwJ2uzSbS5wfkKibKYxw/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;证明&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhud7pRbiaX7VeSib6KHaNXOV1dJPFPk5ibYWRTtlX4hMTh3ccUj3J6fTEA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;立证&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhu9tE8j3Cr6Pf8g6QI0mgz5icibNbM8PY8ialAqHUPzjicOUQJcDsWlNpDQ/0?wx_fmt=png"/&gt;。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;切尔诺夫不等式要求的假设少，只要求随机变量存在特征函数，即可得到Tail的上界。更重要的是，若干独立随机变量之和的特征函数，可以分解为这些随机变量随机变量之积, 也就是&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh6gtqShPSMYf0hYHaoSoazqCQInBSDb5HPxK3KSxmffsnNnEgQpUcCw/0?wx_fmt=png"/&gt;，因此处理一组独立变量变得顺畅。将切尔诺夫不等式应用在掷硬币问题上，我们得到CASE1。&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;CASE 1: 设随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlnUoib31pjQtKL1cQajQtjicdSfIIhyNaMPy10uictQkv8OmDov1hAINA/0?wx_fmt=png"/&gt;是服从Bernoulli分布B(p)的独立同分布样本, 令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhsNV8jSXV9EyrWp1UXhbibE6oCnEE15GgZxM6dmoQJsPFVcjVic5p1Ewg/0?wx_fmt=png"/&gt;为样本均值，则有&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhtm3VYrIDVLJuiaYHmDOknib0Aicz9EQvSrefeZWSyTibbnw4zIQRJLws3A/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;其中&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhIRx5exWjB1u87SzSZ3VKLz8GLDlLmLUMODGmM6XZTpFjqVjtibicwDpA/0?wx_fmt=png"/&gt;, 可以看成以自然底数e为底， Bernoulli分布&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhRY9f7HkA1EFr6pnocrQia5D2w4At7Ix3iaYNwtUoAO6otxtnpFS29ibOg/0?wx_fmt=png"/&gt;与Bernoulli分布&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhfxz8dhvBziaFV1mlxxFhdbZVhNGtyyiaSUaltJcs8uSfiaJSmuapS7EEw/0?wx_fmt=png"/&gt;的KL距离。&lt;/p&gt;&lt;p&gt;证明&lt;br/&gt;实质上， 证明目标为：&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhkhjxchFCbyQKxicUvCBOQnCVH36jdC16sDB8Z7TdDlz3srz9weL49cw/0?wx_fmt=png"/&gt;。根据切尔诺夫不等式， 我们有&lt;br/&gt;&lt;a name="id1761701797" style="border: 0px; vertical-align: baseline; background: transparent;"&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhPY3Kn40GcBLfiahhicZw2q0H2iaYAn55a2J7nwWZibprYX1gkYz0dFicv0w/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;我们只要求得令该值最小的t。用求导法求t&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhPJFBfzut6TI4aoqGs2ASfibibficnk9iciajPZTUhGlT7wqJJdofdE1tcAw/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;求二次导，易知该t使原来的公式后半部分值最小。将t代回原来的公式，经过计算得&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhdhLz5G3JRsReZmYDibHJhoVtzsibIvZrU6hhnp19HmGM4S0AdicPC51Gw/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Case1的证明，利用了特征函数（出现在切尔诺夫不等式中）的性质：若干独立随机变量之和的特征函数，可以分解为这些随机变量特征函数之积。Case1的条件有点强，随机变量的分布必须是Bernoulli分布，离我们的独立同分布的目标还是有点距离的。如果我们把Bernoulli分布这个条件分布去掉，会发生什么呢？ 去掉Bernoulli分布这个条件，我们可以得到下面的Case2。Case2说：不等式依然成立。&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;CASE 2: 设随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlnUoib31pjQtKL1cQajQtjicdSfIIhyNaMPy10uictQkv8OmDov1hAINA/0?wx_fmt=png"/&gt;是独立同分布样本,&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhDTngnMDaYibGqiaPZLiaKbPByXdMDPY2AnXKNpCSt3z9AiawtXOREdE9kg/0?wx_fmt=png"/&gt;, 并且&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhrQH0dXsNniaRTWTf9daLK6namErpgJjhVpcOTnYKTMQ326cad9wPtlQ/0?wx_fmt=png"/&gt;, 令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhsNV8jSXV9EyrWp1UXhbibE6oCnEE15GgZxM6dmoQJsPFVcjVic5p1Ewg/0?wx_fmt=png"/&gt;为样本均值，则有&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhtm3VYrIDVLJuiaYHmDOknib0Aicz9EQvSrefeZWSyTibbnw4zIQRJLws3A/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;证明&lt;br/&gt;我们认真观察Case1的证明， 发现：Bernoulli分布的假设在计算&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhffRzm1R078x4UfMnkJlLg2UsLWcDxyEgurRryjnIX3s9UuIIncF2Mw/0?wx_fmt=png"/&gt;之外没有作用。如果我们能证明，任意存在特征函数的分布有&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhgS4DoOQYLcLqfDPdQxiaiaqUxQdQibjlUNMEOPmqiaEibzSaG63wXdU8XHQ/0?wx_fmt=png"/&gt;, 则能证明Case2。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhFRCnxzU0mJSvCbj13wyibufA9X7LlXOVpGvWFs4UaCNichxlDzVmJZnQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;这时，我们已经达到了我们的目标，量化地给出，一组独立同分布的随机变量平均值和期望之间的差异。但是，进一步观察Case1和Case2的证明，我们发现同分布假设也是多余的。只要变量是独立的，就能保证&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhmpfLnVBcXnVJfGa4yfjxCGyRP0XI7jo2kNLep5l1MQdMzNMDlw6Puw/0?wx_fmt=png"/&gt;，进而保证不等式的成立。&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;CASE 3&lt;br/&gt;设随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlnUoib31pjQtKL1cQajQtjicdSfIIhyNaMPy10uictQkv8OmDov1hAINA/0?wx_fmt=png"/&gt;是独立变量,&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhDTngnMDaYibGqiaPZLiaKbPByXdMDPY2AnXKNpCSt3z9AiawtXOREdE9kg/0?wx_fmt=png"/&gt;, 并且&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhXicUxEZFKiaLR8zCPRHI9VPVKVhG0oicnE2jUkA2rFHibvD6qTGWxmlVWQ/0?wx_fmt=png"/&gt;以及&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhK3wyYiaOfZVN5evw8WJZ7gdRFn6pN8CanPkl0PgtibRtZI7TU3O347zw/0?wx_fmt=png"/&gt;, 令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhsNV8jSXV9EyrWp1UXhbibE6oCnEE15GgZxM6dmoQJsPFVcjVic5p1Ewg/0?wx_fmt=png"/&gt;为样本均值，则有&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhtm3VYrIDVLJuiaYHmDOknib0Aicz9EQvSrefeZWSyTibbnw4zIQRJLws3A/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;作为终极版，Case3超越了我们预设的独立同分布的目标，量化地给出了，一组独立随机变量的平均值和它们数据期望的平均值之间的差距。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;二. 简便形式&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;上述三个Case不够简便，与&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhcxoGUVECnibQiblYLgGwhPLicG65iaImrUibJLc66CUNlKBAfXlj493G08g/0?wx_fmt=png"/&gt;有关。这个给应用带来了一定的困难。因此人们又推导出简便形式，其中加法简便形式是最常用的。&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;加法简便形式：设随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlnUoib31pjQtKL1cQajQtjicdSfIIhyNaMPy10uictQkv8OmDov1hAINA/0?wx_fmt=png"/&gt;是独立变量,&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhDTngnMDaYibGqiaPZLiaKbPByXdMDPY2AnXKNpCSt3z9AiawtXOREdE9kg/0?wx_fmt=png"/&gt;, 并且&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhXicUxEZFKiaLR8zCPRHI9VPVKVhG0oicnE2jUkA2rFHibvD6qTGWxmlVWQ/0?wx_fmt=png"/&gt;以及&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhK3wyYiaOfZVN5evw8WJZ7gdRFn6pN8CanPkl0PgtibRtZI7TU3O347zw/0?wx_fmt=png"/&gt;, 令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhsNV8jSXV9EyrWp1UXhbibE6oCnEE15GgZxM6dmoQJsPFVcjVic5p1Ewg/0?wx_fmt=png"/&gt;为样本均值，则有&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhuGebK8CCMDao50AQicwRYg4gJvbUVDUlZSr81epAgcPMPTAZ2ZIFUicQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;证明&lt;br/&gt;根据&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhJscPjEveibq3wZ7YZ4OzjibwnDkHfibVqPKicJoqDQFeHt8ia3UCLTKKFibg/0?wx_fmt=png"/&gt;的凸性， 很容易推出&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhfvaWyncBY1yjdicNV5M3E2YyN7Lv9lPGkiaSib5tGL2OTNf1Ud6CjaOAA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;三. 进一扩展——Hoeffding不等式&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;到这里，也许大家有一个疑问：不对啊，我们是说变化范围有限的随机变量，怎么直接限制随机变量在0和1之间呢？放宽这个限制，会怎么样？其实，放宽这个限制，我们就得到了著名的Hoeffding不等式。&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;Hoeffding不等式: 设随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlnUoib31pjQtKL1cQajQtjicdSfIIhyNaMPy10uictQkv8OmDov1hAINA/0?wx_fmt=png"/&gt;是独立变量,&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhecnChxyf9ACWKbBgKwckQnWFzb51zrV8RXmPCs9wXtcJCgfDhJVfiag/0?wx_fmt=png"/&gt;, 并且&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhXicUxEZFKiaLR8zCPRHI9VPVKVhG0oicnE2jUkA2rFHibvD6qTGWxmlVWQ/0?wx_fmt=png"/&gt;以及&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhK3wyYiaOfZVN5evw8WJZ7gdRFn6pN8CanPkl0PgtibRtZI7TU3O347zw/0?wx_fmt=png"/&gt;, 令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhsNV8jSXV9EyrWp1UXhbibE6oCnEE15GgZxM6dmoQJsPFVcjVic5p1Ewg/0?wx_fmt=png"/&gt;为样本均值，则有&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh51F7GnrPAbbYdkOVob66S5627w7Tn6hic1jLf22MAibJFz7k5KK3pdkQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;证明&lt;br/&gt;我们先证明一个引理：如果随机变量&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhZFWUqGUSs9oia0wIn40K2xtFicicxEoIraSqs847PKf2HEib5czBSeGAYg/0?wx_fmt=png"/&gt;, E[X] = 0 ,&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhKJrlpicfGfh3t1ug4h78ndlWhSiccmHzGCpdyKxTCdFRCL3EYZiaTGR4g/0?wx_fmt=png"/&gt;。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhVaPib0rrjttBJuTaia6Ndg9ttafIecVyrUK9l3dAdJsqZPPEH2tcfJlg/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhlslqEqBXJsIoiaUAgpnxfD6N5HJicF24xPPlCCehLBdsR6NedQVW7gVg/0?wx_fmt=png"/&gt;, 因E[x] =0，所以a&amp;lt;0, 即&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhjrKR3fM8cFVHicUwT3RpwuoOhxf8kfQkw9wSH9c8lWAuvc4enWUpb2g/0?wx_fmt=png"/&gt;; 令&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhWCMrryNtImnbOoRYeib3GZEK5kISZ2vSqibkgF1ZN8Qfibx4zeM3A2XFw/0?wx_fmt=png"/&gt;, 则在t&amp;gt;0的情况下, u &amp;gt; 0 。 此时有：&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh6566yLxEZUhibrahyYico1FG2TWQsAnibd1HDf80829wd83nVjh0HlYPA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;由于&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhj8kJEml3jVqM4G8b7ySTlXLJMnrVbllB8kTSorjvNqtiaGxsvbqoILQ/0?wx_fmt=png"/&gt;&amp;nbsp;, 因此&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh38HXp5QTA2qHWcibNTYT8JmLkQcDJfoGUzMvmKcs8W9SuhS8ictYZsTA/0?wx_fmt=png"/&gt;&amp;nbsp;。&lt;/p&gt;&lt;p&gt;定义函数g(u):&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhAr0I92BqEYg4Ivy7pEricS8VJLlyIsSngfY6wibZkftplAIAFXticqAGg/0?wx_fmt=png"/&gt;。 根据泰勒公式， 存在&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhHib4bNicDiadoiavTfNdpNzQLEzOuBldVZtIrEvVtEMsBj8HQ8eJd40icQg/0?wx_fmt=png"/&gt;,&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhFXBoStKLLFX1ibwPVFFricSaFKSUbrkWKE8icfxyia86MtKAX3Zq0lnYJQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;经过计算，&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhvmQhAESr239k3xrZn8UVsGU7RhryIMmTib4KHak43d7Tu9axTPo3I6g/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;由于&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhjrKR3fM8cFVHicUwT3RpwuoOhxf8kfQkw9wSH9c8lWAuvc4enWUpb2g/0?wx_fmt=png"/&gt;&amp;nbsp;和&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhgczNWI8D6YKNuzwxfzBBG0UZxgYhkaG4qFBrVHcDIfFMSTNAusE5RA/0?wx_fmt=png"/&gt;, 即&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhm6MKVuH5qDNicLmlUJtYW4sicVkyALMoDo4HXqRVLwbAB4cb6UTfuaDQ/0?wx_fmt=png"/&gt;, 得&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh7vkBVKFYpFDAIlaEKibFOtdYQsHxLXEqAkFx83XXDohxprKZ4CmOVWw/0?wx_fmt=png"/&gt;&amp;nbsp;。 从而&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhiabNPVqNsFPBy5JI42JE6s9sMCAmicU7w67rxEDATcs19desQrRv3pKw/0?wx_fmt=png"/&gt;。 根据g的定义，有&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVh78X2Co5ic6ajWIBe90qaQcTXUfM54nWWmialLYCkmqEZgicSwLjuKZgLA/0?wx_fmt=png"/&gt;。&lt;/p&gt;&lt;p&gt;接着证明Hoeffding不等式：&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvPJfichQKgewbov27UQR7CVhCVaR2YicLp7zZBkPb5icjyiaPNVKGCbOZ0zfangdrtI4QunLvpqHN8NOQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;欢迎大家关注 AlgorithmDog&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz/Q3H1TCddfvPE2JpYR7tQ2eqqCLpF5ncuTx6MNCib7Qd3FF67BsxicqGoLo1Y44rRGAah5gUfUrV6QTjIVaanBsDA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;/blockquote&gt;</description>
      <pubDate>Tue, 30 Aug 2016 00:32:27 +0800</pubDate>
    </item>
    <item>
      <title>Metropolis-Hastings 和Gibbs sampling</title>
      <link>http://www.iwgc.cn/link/2379663</link>
      <description>&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; 在科学研究中，如何生成服从某个概率分布的样本是一个重要的问题。 如果样本维度很低，只有一两维，我们可以用反切法、拒绝采样和重要性采样等方法。 但是对于高维样本，这些方法就不适用了。这时我们就要使用一些 “高档” 的算法，比如下面要介绍的 Metropolis-Hasting 算法和 Gibbs sampling 算法。&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Metropolis-Hasting 算法和 Gibbs sampling 算法是马尔科夫链蒙特卡洛（Markov Chain Mento Carlo, MCMC）方法。我们先介绍 MCMC 方法。&lt;/p&gt;&lt;h3 style=" border: 0px; margin-bottom: 10px; vertical-align: baseline; clear: both; line-height: 1.5em; ; ; ; ; "&gt;&lt;span&gt;1. 马尔科夫蒙特卡洛方法&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MCMC 方法是用蒙特卡洛方法去体现马尔科夫链的方法。马尔科夫链是状态空间的转换关系，下一个状态只和当前的状态有关。比如下图就是一个马尔科夫链的示意图。&lt;/p&gt;&lt;p&gt;&lt;a rel="attachment wp-att-3276" style="border: 0px; vertical-align: baseline; color: rgb(116, 51, 153); background: transparent;"&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PJ7xEox3abqiaVGHGhzZuqibX27ztnRsUSgCJb3TpPI7FJUaJH9dhXuuw/0?wx_fmt=png"/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;图中转移关系可以用一个概率转换矩阵 p 表示，&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmsns.qpic.cn/mmsns/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PtttDiabxEul303xSfSytZsw/0"/&gt;&lt;/p&gt;&lt;p&gt;如果当前状态分布为&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PB0tDRBBGcfHsF1Sv5vocqUaS7qxLwDz5RvCbxaGGhIgqYqjwMIFlVA/0?wx_fmt=png"/&gt;, 那么下一个矩阵的状态就是&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PIQSJ6MxZHAzwPnqb3A1hDTylXbibzVfGhhPY6coq40VnAASWS6Dn1zQ/0?wx_fmt=png"/&gt;, 再下一个就是&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PAbzb167XcmZdBiaibcibUQseJ9ricmUQwy4AWHiaPweIG9H7EviaW1NhhyiaQ/0?wx_fmt=png"/&gt;,... 最后会收敛到一个平稳分布&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PUp9VSzEw0rtfu0FticmqRVRyTauEDCVqAuZdGNs2j5I1atEZ62bolZg/0?wx_fmt=png"/&gt;。这个平稳分布&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PUp9VSzEw0rtfu0FticmqRVRyTauEDCVqAuZdGNs2j5I1atEZ62bolZg/0?wx_fmt=png"/&gt;&amp;nbsp;只和概率转移矩阵 p 有关，而和初始状态分布 u 是什么没有关系。&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;如何判断一个马尔科夫链是否能收敛到平稳分布，以及如何判断一个状态分布是不是一个马尔科夫链的平稳分布呢？我们有下面定理。&lt;/p&gt;&lt;blockquote style=" border: 0px; padding-right: 3em; padding-left: 3em; vertical-align: baseline; quotes: none; font-style: italic; color: rgb(51, 51, 51); ; ; ; ; ; "&gt;&lt;p&gt;细致平衡条件: &lt;span&gt;已知各态历经的的马尔科夫链有概率转移矩阵&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PuyZMa407NoQz4x0RIoZWOicEEIXdt2uEXqOqWEaLIYAGx6NwIaIGo1A/0?wx_fmt=png"/&gt;&lt;span&gt;，以及已知状态分布&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PUp9VSzEw0rtfu0FticmqRVRyTauEDCVqAuZdGNs2j5I1atEZ62bolZg/0?wx_fmt=png"/&gt;&lt;span&gt;。如果对于任意两个状态 i 和 j，下面公式成立，则马尔科夫链能够收敛到&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PUp9VSzEw0rtfu0FticmqRVRyTauEDCVqAuZdGNs2j5I1atEZ62bolZg/0?wx_fmt=png"/&gt;。&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PTGxibmz9kKvY0mDeNOEMiaxIm8icKlkTQ0fYlBXjfEoXHZ5Ud4UVxndYA/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;这里的各态历经是指任意两个状态之间可以通过有限步到达。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;怎么证明细致平衡条件呢？我也不知道啊。&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;MCMC 方法的基本原理是利用细致平衡条件构建一个概率转移矩阵，使得目标概率就是概率转移矩阵的平稳分布。 Metropolis-Hasting 和 Gibbs sampling 算法本质上是构建概率转移矩阵的不同方法。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;h3 style=" border: 0px; margin-bottom: 10px; vertical-align: baseline; clear: both; line-height: 1.5em; ; ; ; ; ; "&gt;&lt;span&gt;2. Metropolis-Hastings 算法&lt;/span&gt;&lt;/h3&gt;&lt;hr&gt;&lt;h3 style=" border: 0px; margin-bottom: 10px; vertical-align: baseline; clear: both; line-height: 1.5em; ; ; ; ; "&gt;&lt;span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Metropolis-Hastings 算法先提出一个可能不符合条件的概率转移矩阵 q, 然后再进行调整。比如我们提出的 q 是均匀概率，即从任意状态到任意状态的概率是相等的。显然在绝大部分情况下，q 的稳定概率不是目标概率&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PUp9VSzEw0rtfu0FticmqRVRyTauEDCVqAuZdGNs2j5I1atEZ62bolZg/0?wx_fmt=png"/&gt;，即不满足细致平衡条件。&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2P7TCruVxEvmuHfiaDOAtrIMB96Foc9Peib6slUqxyfXjejSzph2QpfsdQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;如何让这个不等式转变成等式呢？根据对称性，我们容易得到下面的等式。&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PX9zhFLOl1872icLY8gQEjewQ6YMoDia9P6byuBdyK4RujuCNl9AWuVdQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;这时整个概率转移矩阵满足细致平衡条件。从 i 状态转到 j 状态的概率是&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PX19FwUjljh3w6NasagIH8UroibW4IwFjbmbAcxh1KzuEyyHlfCCK5RQ/0?wx_fmt=png"/&gt;，实现这个转移概率的方式是 i 状态以 q(j|i) 概率跳转到 j 状态，然后以&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PycM9ENLgicia9up8ch0u2zEjQhdtQkqKNV5traq3XtDXFibTia9rQpT5kA/0?wx_fmt=png"/&gt;&amp;nbsp;接受跳转 (拒绝跳转就退回 i 状态)。这样整个 Metropolis-Hasting 算法的框架就建立起来了。&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;这个原始的 Metropoli-Hasting 算法的有一个小问题。 &lt;span&gt;跳转接受概率&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PycM9ENLgicia9up8ch0u2zEjQhdtQkqKNV5traq3XtDXFibTia9rQpT5kA/0?wx_fmt=png"/&gt;&lt;span&gt;&amp;nbsp;和&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2P0eFspbMkZuIvdsnGJgzBulXFzZ5OwFXNibT2SWI67pgxePsVDQm9b8A/0?wx_fmt=png"/&gt;&lt;span&gt;的值很小&lt;/span&gt;，算法进行过程充斥着跳转拒绝。为了改进这点，Metropoli-Hasting 算法的方法是公式两边同时乘以一个系数，使得&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PycM9ENLgicia9up8ch0u2zEjQhdtQkqKNV5traq3XtDXFibTia9rQpT5kA/0?wx_fmt=png"/&gt;&amp;nbsp;和&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2P0eFspbMkZuIvdsnGJgzBulXFzZ5OwFXNibT2SWI67pgxePsVDQm9b8A/0?wx_fmt=png"/&gt;&amp;nbsp;中大的一项 scale 到 1，得到下面的公式。&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2P6scG5ETz5y4Jbxbt3yxd6X2apMFib3de7a37RJRXuibaTROsVKkoG4BQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;这个公式可以进一步简化为下面的公式&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PQa49GYHcdo6HTCYBJs4icX7CKJeQOrxtGd3P6kbRcUr7xqDtK64LAqw/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;根据上面的推导，我们容易得到 Metropolis-Hasting 算法的流程。&lt;/p&gt;&lt;p&gt;&lt;a rel="attachment wp-att-3184" style="border: 0px; vertical-align: baseline; color: rgb(116, 51, 153); background: transparent;"&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PJboa8qMTHRhsR56F2AWnCGO4uTvwJHAoQ6rIGraPt8CC7P6RItZR1w/0?wx_fmt=png"/&gt;&lt;/a&gt;&lt;/p&gt;&lt;h3 style=" border: 0px; margin-bottom: 10px; vertical-align: baseline; clear: both; line-height: 1.5em; ; ; ; ; "&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/h3&gt;&lt;h3 style=" border: 0px; margin-bottom: 10px; vertical-align: baseline; clear: both; line-height: 1.5em; ; ; ; ; ; "&gt;&lt;span&gt;3. Gibbs sampling 算法&lt;/span&gt;&lt;/h3&gt;&lt;hr&gt;&lt;h3 style=" border: 0px; margin-bottom: 10px; vertical-align: baseline; clear: both; line-height: 1.5em; ; ; ; ; "&gt;&lt;span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Gibbs sampling 算法是 Metropolis-Hasting 算法的一个特例。很鸡贼的一个特例。m 维的一个样本跳转到另一个样本的过程，可以拆解为 m 个子过程，每一个子过程对应一个维度。这时概率转移矩阵是 m 个子概率转移矩阵之积，即&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PSNd3V0jnfOvnLmSm2LwAdvXkuZIhk6XugA3f11BicePPv6lBLQE92zQ/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;其中&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PlNrXRjtfeP44wNicMentI9EL7VOvZ2JNx0Uu2s4T5KibknsC4E7BtfzQ/0?wx_fmt=png"/&gt;&amp;nbsp;表示第 k 维的变化概率。在&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PlNrXRjtfeP44wNicMentI9EL7VOvZ2JNx0Uu2s4T5KibknsC4E7BtfzQ/0?wx_fmt=png"/&gt;&amp;nbsp;中，两个状态之间只有 k 维不同，其跳转概率如下所示；不然为 0。&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PWYo1yPHBXg84npqNh7rrdlXa65y3z638XdtVz0JHuW48ZtfPtxLeyA/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;其中&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2P80fIrQKWpTMOt40Lh0mZibjFRE0icXgfkcyibMgzVyA0u0Qy0EclWAqbQ/0?wx_fmt=png"/&gt;&amp;nbsp;表示样本第 k 维数据为&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PTiav5R5q6pESu7CCWE3dzHII8oJR1vhEJWrOGkxrT0TIR0ZGm91InaA/0?wx_fmt=png"/&gt;，其它维度固定。这时候我们发现如下公式&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PslwiadiaN0Dt84GUzib9WatpBHs0rOhaAUEyQym8dpsSWW9qe92NOvFVA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;即&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PlNrXRjtfeP44wNicMentI9EL7VOvZ2JNx0Uu2s4T5KibknsC4E7BtfzQ/0?wx_fmt=png"/&gt;&amp;nbsp;和&amp;nbsp;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PUp9VSzEw0rtfu0FticmqRVRyTauEDCVqAuZdGNs2j5I1atEZ62bolZg/0?wx_fmt=png"/&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;满足细致平衡条件的等式。那么&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PlNrXRjtfeP44wNicMentI9EL7VOvZ2JNx0Uu2s4T5KibknsC4E7BtfzQ/0?wx_fmt=png"/&gt;&amp;nbsp;就是我们要构建的概率转移矩阵嘛？答案是否定的。因为完整的细致平衡条件需要各态历经。在概率转移矩阵&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PlNrXRjtfeP44wNicMentI9EL7VOvZ2JNx0Uu2s4T5KibknsC4E7BtfzQ/0?wx_fmt=png"/&gt;&amp;nbsp;下, 只有 k 维数据子啊变化，因此一个状态永远不能到达和它第 k-1 维数据不同的状态。&lt;/p&gt;&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;最终我们构建的概率转移矩阵是 m 个子概率转移矩阵之积&lt;/p&gt;&lt;p&gt;&lt;span&gt;(9)&lt;/span&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PwnQwviaD5ubjTXvZBf1WK5xriclBFn3S8gAOt2DALw4yNI5vYzsLtSSA/0?wx_fmt=png"/&gt;&lt;/p&gt;&lt;p&gt;我们很容易证明&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2PuyZMa407NoQz4x0RIoZWOicEEIXdt2uEXqOqWEaLIYAGx6NwIaIGo1A/0?wx_fmt=png"/&gt;&amp;nbsp;依然满足细致平衡条件中的等式，同时还满足各态历经。根据上述推导，我们得到 Gibbs sampling 的算法过程。&lt;/p&gt;&lt;p&gt;&lt;a rel="attachment wp-att-3184" style=" border: 0px; vertical-align: baseline; color: rgb(116, 51, 153); ; ; ; ; ; ; "&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMKdLNCEn6EVEdHloGmtD2P1QMwH8sibyqVI6oCWsGXd5F7arGYqrQfjpNXzdeqicwic8aAwTYQADrYg/0?wx_fmt=png"/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;欢迎关注 AlgorithmDog&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz/Q3H1TCddfvPE2JpYR7tQ2eqqCLpF5ncuTx6MNCib7Qd3FF67BsxicqGoLo1Y44rRGAah5gUfUrV6QTjIVaanBsDA/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;</description>
      <pubDate>Mon, 22 Aug 2016 13:29:10 +0800</pubDate>
    </item>
  </channel>
</rss>
