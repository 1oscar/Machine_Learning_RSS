<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
  <channel>
    <title>AlgorithmDog</title>
    <link>http://www.iwgc.cn/list/5566</link>
    <description>AlgorithmDog 讲述机器学习和系统研发的轶事,希望把这些事讲得生动有趣.每周日更新哦.欢迎关注.</description>
    <item>
      <title>Kmeas 特征处理的经验</title>
      <link>http://www.iwgc.cn/link/3414657</link>
      <description>&lt;p&gt;&lt;span&gt;&lt;span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; 本文是我同事谢思发同学的文章。Kmeans &lt;/span&gt;&lt;/span&gt;&lt;span&gt;聚类算法&lt;/span&gt;&lt;span&gt;是数据挖掘十大算法之一&lt;/span&gt;&lt;span&gt;。这里&lt;/span&gt;&lt;span&gt;总结一些使用 Kmeans 的心得&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;主要是特征的处理方面。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;枚举型特征&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&amp;nbsp; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;根据K&lt;/span&gt;&lt;span&gt;means&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;原理，枚举型的特征不&lt;/span&gt;&lt;span&gt;适用于 &lt;span&gt;Kmeans&lt;/span&gt; 聚类&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;span&gt;例&lt;/span&gt;&lt;span&gt;如&lt;/span&gt;&lt;span&gt;有&lt;/span&gt;&lt;span&gt;个&lt;/span&gt;&lt;span&gt;特征是&lt;/span&gt;&lt;span&gt;英雄&lt;/span&gt;&lt;span&gt;的类型，取值&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;-5&lt;/span&gt;&lt;span&gt;。首先在&lt;/span&gt;&lt;span&gt;聚类过程中会对特征取均值，而&lt;/span&gt;&lt;span&gt;对枚举&lt;/span&gt;&lt;span&gt;型&lt;/span&gt;&lt;span&gt;特征&lt;/span&gt;&lt;span&gt;取均值没有意义&lt;/span&gt;&lt;span&gt;。另外 &lt;span&gt;Kmeans&lt;/span&gt; 是&lt;/span&gt;&lt;span&gt;根据&lt;/span&gt;&lt;span&gt;空间&lt;/span&gt;&lt;span&gt;距离&lt;/span&gt;&lt;span&gt;的远近&lt;/span&gt;&lt;span&gt;来&lt;/span&gt;&lt;span&gt;对&lt;/span&gt;&lt;span&gt;数据点进行聚类的&lt;/span&gt;&lt;span&gt;。这样，在算法层面上，取值 &lt;/span&gt;&lt;span&gt;1 的实例&lt;/span&gt;&lt;span&gt;比&lt;/span&gt;&lt;span&gt;取值 &lt;/span&gt;&lt;span&gt;5 的实例&lt;/span&gt;&lt;span&gt;更接近&lt;/span&gt;&lt;span&gt;取值 &lt;/span&gt;&lt;span&gt;2 的实例&lt;/span&gt;&lt;span&gt;，但在实际意义中，不同类型的实例间不存在远近的关系。&lt;/span&gt;&lt;span&gt;在&lt;/span&gt;&lt;span&gt;其他算法中，如 &lt;/span&gt;&lt;span&gt;LR，&lt;/span&gt;&lt;span&gt;会将枚举型特征进行 one-hot &lt;/span&gt;&lt;span&gt;编码&lt;/span&gt;&lt;span&gt;，像&lt;/span&gt;&lt;span&gt;类型特征会转换成一个长度为 &lt;/span&gt;&lt;span&gt;5 的&lt;/span&gt;&lt;span&gt;特征向量&lt;/span&gt;&lt;span&gt;，根据&lt;/span&gt;&lt;span&gt;类型&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;将对应位置的值设为&lt;/span&gt;&lt;span&gt;1。&lt;/span&gt;&lt;span&gt;但是&lt;/span&gt;&lt;span&gt;这种方法&lt;/span&gt;&lt;span&gt;不适合Kmeans &lt;/span&gt;&lt;span&gt;聚类&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;span&gt;在 Kmeans &lt;/span&gt;&lt;span&gt;中&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;为&lt;/span&gt;&lt;span&gt;防止某些大值属性的数据左右样本间的距离&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;会&lt;/span&gt;&lt;span&gt;对&lt;/span&gt;&lt;span&gt;特征&lt;/span&gt;&lt;span&gt;进行&lt;/span&gt;&lt;span&gt;正规化&lt;/span&gt;&lt;span&gt;处理，一般会将特征&lt;/span&gt;&lt;span&gt;值&lt;/span&gt;&lt;span&gt;转换到 &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;-1 &lt;/span&gt;&lt;span&gt;中。在&lt;/span&gt;&lt;span&gt;归一化处理后，只&lt;/span&gt;&lt;span&gt;取值0/1的特征&lt;/span&gt;&lt;span&gt;就会变成强特征，对聚类有很大的影响。&lt;/span&gt;&lt;span&gt;一个&lt;/span&gt;&lt;span&gt;直观的理解，&lt;/span&gt;&lt;span&gt;假设&lt;/span&gt;&lt;span&gt;只有两&lt;/span&gt;&lt;span&gt;维&lt;/span&gt;&lt;span&gt;特征，其中一个取值&lt;/span&gt;&lt;span&gt;0/1。&lt;/span&gt;&lt;span&gt;那么&lt;/span&gt;&lt;span&gt;归一化&lt;/span&gt;&lt;span&gt;处理后，样本的分布&lt;/span&gt;&lt;span&gt;就&lt;/span&gt;&lt;span&gt;会位于两条&lt;/span&gt;&lt;span&gt;线段&lt;/span&gt;&lt;span&gt;上，大致如下：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMnmtunfOsh01CEZrpxr9cicaY4TlxSsTBtIbfkT15bibcgoSPSFia2hW25YfhFLXIFLdtyAb1XvtvXw/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;对这些数据进行聚类的话，如果初始点分布在两侧，那么&lt;/span&gt;&lt;span&gt;两条线段的数据会被分开，&lt;/span&gt;&lt;span&gt;只会在两条&lt;/span&gt;&lt;span&gt;线段上&lt;/span&gt;&lt;span&gt;分别&lt;/span&gt;&lt;span&gt;进行聚类。位于&lt;/span&gt;&lt;span&gt;不同&lt;/span&gt;&lt;span&gt;线段&lt;/span&gt;&lt;span&gt;上&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;两个&lt;/span&gt;&lt;span&gt;点&lt;/span&gt;&lt;span&gt;，它们&lt;/span&gt;&lt;span&gt;之&lt;/span&gt;&lt;span&gt;间的距离&lt;/span&gt;&lt;span&gt;大于等于1，&lt;/span&gt;&lt;span&gt;大于&lt;/span&gt;&lt;span&gt;线段&lt;/span&gt;&lt;span&gt;内&lt;/span&gt;&lt;span&gt;两两&lt;/span&gt;&lt;span&gt;点之间的&lt;/span&gt;&lt;span&gt;距离&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;span&gt;同理&lt;/span&gt;&lt;span&gt;在三维中，如果有&lt;/span&gt;&lt;span&gt;个&lt;/span&gt;&lt;span&gt;特征只取值&lt;/span&gt;&lt;span&gt;0/1，&lt;/span&gt;&lt;span&gt;那么数据是分布在两个&lt;/span&gt;&lt;span&gt;正方形&lt;/span&gt;&lt;span&gt;面&lt;/span&gt;&lt;span&gt;上&lt;/span&gt;&lt;span&gt;的&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;聚类也很可能&lt;/span&gt;&lt;span&gt;在&lt;/span&gt;&lt;span&gt;每&lt;/span&gt;&lt;span&gt;个面&lt;/span&gt;&lt;span&gt;内单独&lt;/span&gt;&lt;span&gt;进行。&lt;/span&gt;&lt;span&gt;所以如果采用&lt;/span&gt;&lt;span&gt;one-hot编码，那些0/1特征在很大程度上就决定了聚类结果，其他特征的重要性变很小了。但有时这种枚举型数据又很重要，可以很好地用来刻画实例，那么我们的做法是在聚完类后，将聚类结果和枚举数据做交叉分析。看在每类中，枚举值的分布情况。&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;长尾特征&lt;/span&gt;&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们进行用户行为分析时，会用到和用户行为相关数据做特征，比如登录次数、登录时长和好友数等。这些数据一般会有长尾问题。并且有些特征之间存在线性关系，用户在一个特征上的取值大时，在其他特征上的取值也会较大。比如活跃用户在一个登录时长长，好友数很大可能是比较大的。这时候特征分布如下所示，极端用户影响 kmeans 对普通用户的刻画。&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMnmtunfOsh01CEZrpxr9cichCEpQCrVGNvDUicqfkicbSno0ffXMn8hIH11hFJSjss6c46mciaibrXRbA/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;可以看到下面分布图中，80%的数据分布在1%的空间内，而剩下的20%的数据分布在99%的空间内。聚类时，分布在1%空间内的大部分数据会被聚为一类，剩下的聚为一类。当不断增加K值时，模型一般是对99%空间内的数据不断进行细分，因为这些数据之间的空间距离比较大。而对分布在1%空间内的数据则很难进一步细分，或者即使细分了，也只是剥离出了外侧少量数据。下图是我们在某个项目中的聚类结果，可以看到有一类用户占了90%以上，而且随着K的增加，这类用户里只有很小一部分数据会被划分出来。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_jpg/Q3H1TCddfvMnmtunfOsh01CEZrpxr9cicJKwtaaHmeh5abIv0eaTibic3zLxlWOxUHc1yuygCWic4TN2dwjc1qFUcw/0?wx_fmt=jpeg"/&gt;&lt;br/&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;那么为了解决这个问题，&lt;/span&gt;&lt;span&gt;一种可行的方法是是对特征取&lt;/span&gt;&lt;span&gt;LOG，减轻长尾问题。经过这两种方法处理后，都能较好的对玩家进行分类。下图是上图中的数据点取LOG后得到的分布图。&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMnmtunfOsh01CEZrpxr9cicYNbXJ0oHoxRF98ObYF49YG3c5TZPhc2PL5bRXv6oV8nO16BmicwuGAg/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;特征值取LOG后，k=4的分类结果。&lt;/span&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_jpg/Q3H1TCddfvMnmtunfOsh01CEZrpxr9cic7Yz2ImS06IH2USzjaFVcAMNccgnwUEYneOxcunLkGwJd66pPurnS8g/0?wx_fmt=jpeg"/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;取LOG的方法的缺点在于，会使数据变得不直观，不好理解。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;总结&lt;/p&gt;&lt;hr&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&amp;nbsp; 谢同学是单身，你懂的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvMDJbrOSC3UBtULxFVZ0IYy8Rkhk7eibEUQXrZLWRgwB86mbFvjax9CYV9vibCOUzBkjtmvkR7Scf0Q/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;</description>
      <pubDate>Tue, 08 Nov 2016 13:22:37 +0800</pubDate>
    </item>
  </channel>
</rss>
